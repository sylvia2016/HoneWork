@model IEnumerable<HomeWork.Models.客戶資料>

@{
    ViewBag.Title = "Index";
}

@section scripts{
    <script>
        function Sort(SortOrder, SortColumn) {
            $('#SortOrder').val(SortOrder);
            $('#SortColumn').val(SortColumn);

            document.form1.submit();
            return false;
        }
    </script>
}
<h2>客戶資料管理</h2>


@using (Html.BeginForm("Index", "客戶資料", FormMethod.Get, new { name = "form1" }))
{
    <p>
        <table style="width:100%">
            <tr>
                <td style="text-align:left">
                    @Html.ActionLink("新增客戶資料", "Create")
                </td>
                <td style="text-align:left">
                    @Html.ActionLink("匯出客戶資料", "Export")
                </td>
                <td style="text-align:right">
                    @Html.TextBox("searchWord")
                    <input type="submit" value="搜尋" />
                </td>
            </tr>
        </table>
    </p>

    @Html.Hidden("SortOrder")
    @Html.Hidden("SortColumn")
    @Html.Hidden("Page")

    <table class="table">
        <tr>
            <th>
                @Html.ActionLink("客戶名稱", "Index", null, new { @onclick = string.Format("return Sort('{0}','{1}')", ViewBag.SortOrder, "客戶名稱") })
            </th>
            <th>
                @Html.ActionLink("統一編號", "Index", null, new { @onclick = string.Format("return Sort('{0}','{1}')", ViewBag.SortOrder, "統一編號") })
            </th>
            <th>
                @Html.ActionLink("電話", "Index", null, new { @onclick = string.Format("return Sort('{0}','{1}')", ViewBag.SortOrder, "電話") })
            </th>
            <th>
                @Html.ActionLink("傳真", "Index", null, new { @onclick = string.Format("return Sort('{0}','{1}')", ViewBag.SortOrder, "傳真") })
            </th>
            <th>
                @Html.ActionLink("地址", "Index", null, new { @onclick = string.Format("return Sort('{0}','{1}')", ViewBag.SortOrder, "地址") })
            </th>
            <th>
                @Html.ActionLink("Email", "Index", null, new { @onclick = string.Format("return Sort('{0}','{1}')", ViewBag.SortOrder, "Email") })
            </th>
            <th>
                @Html.ActionLink("地區", "Index", null, new { @onclick = string.Format("return Sort('{0}','{1}')", ViewBag.SortOrder, "地區") })
            </th>
            <th></th>
        </tr>

        @foreach (var item in Model)
        {
            <tr>
                <td>
                    @Html.DisplayFor(modelItem => item.客戶名稱)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.統一編號)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.電話)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.傳真)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.地址)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Email)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.地區)
                </td>
                <td>
                    @Html.ActionLink("編輯", "Edit", new { id = item.Id }) |
                    @Html.ActionLink("詳細資訊", "Details", new { id = item.Id }) |
                    @Html.ActionLink("刪除", "Delete", new { id = item.Id })
                </td>
            </tr>
        }

    </table>
}